# 证书文件上传功能测试报告
## 测试基本信息
| 项目 | 内容 |
|------|------|
| 测试模块 | 证书文件上传（学生/教师功能） |
| 测试环境 | Windows 10 + Python 3.10 + Streamlit 1.35.0 |
| 测试时间 | 2025-12-23 |
| 测试目的 | 验证文件上传的格式/大小校验、保存、元信息记录功能 |

## 测试用例
| 用例ID | 测试场景 | 测试步骤 | 预期结果 | 实际结果 | 测试状态 |
|--------|----------|----------|----------|----------|----------|
| TC-001 | 上传合法PDF证书（5MB） | 1. 登录学生账号；<br>2. 上传valid_cert.pdf；<br>3. 点击确认上传 | 1. 上传成功；<br>2. 文件保存到uploaded_files目录；<br>3. 数据库files表记录元信息；<br>4. 页面显示上传结果 | 与预期一致 | 通过 |
| TC-002 | 上传合法JPG图片（2MB） | 1. 登录教师账号；<br>2. 上传valid_cert.jpg | 1. 上传成功；<br>2. 生成唯一文件名；<br>3. 已上传文件列表显示该文件 | 与预期一致 | 通过 |
| TC-003 | 上传非法格式文件（TXT） | 上传invalid.txt | 1. 文件上传框不识别该文件；<br>2. 无法选择上传 | 与预期一致 | 通过 |
| TC-004 | 上传超大文件（15MB PDF） | 上传oversized.pdf | 1. 提示“文件大小超过限制（最大10MB）”；<br>2. 上传失败 | 与预期一致 | 通过 |
| TC-005 | 上传后缀篡改的文件（改PDF为JPG） | 1. 将PDF文件后缀改为.jpg；<br>2. 上传该文件 | 1. 提示“文件后缀为jpg，但实际不是图片文件”；<br>2. 上传失败 | 与预期一致 | 通过 |
| TC-006 | 验证文件元信息记录 | 上传合法文件后查看数据库 | 1. files表包含user_id、文件名、路径、类型、大小；<br>2. 字段值与实际一致 | 与预期一致 | 通过 |

## 测试结果
- 总测试用例：6个
- 通过：6个
- 失败：0个

## 问题与优化建议
| 问题ID | 问题描述 | 修复建议 |
|--------|----------|----------|
| P001 | 无文件覆盖保护（同名文件可能被覆盖） | 已通过生成唯一文件名解决，无需额外修复 |
| P002 | 无文件删除功能 | 后续可新增“删除已上传文件”按钮，同步删除本地文件和数据库记录 |
| P003 | 无批量上传功能 | 可扩展file_uploader的accept_multiple_files=True，支持批量上传 |

## 总结
1. 核心功能：文件上传、格式/大小校验、本地保存、元信息记录均正常工作；
2. 异常处理：非法文件/超大文件能有效拦截并给出清晰提示；
3. 兼容性：适配学生/教师角色的上传权限，集成到现有登录框架中。